version: v1alpha1
metadata:
  name: frr
  version: v1.7.6
  author: Kai Zhang (kimi.zhangkai@gmail.com), Jonathan Senecal (contact@jonathansenecal.com)
  description: |
    This system extension provides FRR BGP routing on the host with Cilium integration.
    v1.7.6: Add tmpfs mounts for /var/run/frr, /var/lib/frr, /var/log/frr - fixes FRR daemon startup (PID files, sockets, logs).
    v1.7.5: Use tmpfs overlay for /etc/frr - makes config directory writable in-memory without host mounts. Removes unnecessary version tracking.
    v1.7.4: Fix version marker - write .initialized to /run/frr instead of read-only /etc/frr. Prevents crash loop.
    v1.7.3: Use container's internal /run for writable paths. Remove host bind mounts from frr.yaml. Fixes daemon startup by using writable tmpfs inside container.
    v1.7.2: Remove unnecessary bind mount code from docker-start.sh. Host mounts via frr.yaml handle writable paths.
    v1.7.1: Mount writable /run directories from host into container. Fixes daemon startup by providing writable filesystem paths.
    v1.7.0: Use bind mounts instead of symlinks for writable directories. Handles /var/run/frr, /var/tmp/frr, /var/lib/frr, /var/log/frr.
    v1.6.9: Create writable FRR runtime directories (/var/run/frr, /var/tmp/frr, /var/lib/frr) in /run tmpfs - fixes daemon startup failures.
    v1.6.8: Fix read-only filesystem error - use /run/config.json instead of /tmp/config.json for config storage.
    v1.6.7: Add IPv4 veth address configuration for dual-stack Cilium BGP peering. Enables both IPv4 and IPv6 peering sessions with Cilium.
    v1.6.6: Re-enable network namespace isolation using unshare. Now that Dockerfile structure is fixed, this will correctly isolate FRR from the host network.
    v1.6.5: Fix Dockerfile structure - place manifest.yaml at root level. Required for Talos imager validation.
    v1.6.4: Force network namespace isolation using unshare. Fixes issue where FRR ran in host namespace despite hostNetwork: false.
    v1.6.3: Implement network namespace isolation (hostPID: true, hostNetwork: false). Mirrors host loopbacks to dummy0 for advertisement.
    v1.6.2: Fix template syntax error (missing endif) in IPv4 address family block.
    v1.6.1: Fix crash loop by making IPv4 peering optional. Enables MP-BGP over IPv6 for Cilium peering (RFC 5549).
    Configuration-only approach with network announcement filtering per peer.
  compatibility:
    talos:
      version: ">= v1.5.0"
